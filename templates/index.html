<!DOCTYPE html>
<html lang="en">
<head>
    {% include 'subtemplates/head_shared.html' %}
    <title>HANSEL - E-Texts</title>
</head>
<body>
<div id="content">
    {% include 'subtemplates/sidenav_full.html' %}

    <div class="main">
        <div id="introduction">
            <h1>Introduction</h1>
            <p>
                HANSEL is an open collection of Sanskrit e-texts of all sorts.
                The current collection size is {{ num_items }} items ({{ total_size_mb }} mb in total).
            </p>
            <p>
                Below is a simple alphabetical listing by work title. Click the arrows beside items for more info.
                There's also a <a href="table">tabular view</a> for sorting by author, genre, etc.
            </p>
        </div>

        <div id="e-texts">
            <h1>E-Texts</h1>
            <ul>
                {% for item in metadata %}
                <li class="file-item">
                    <div class="link-and-caret">
                        {% set highest_medallion = item['Highest Medallion'] | lower %}
                        {% set medallion_path = '1_bronze' if highest_medallion == 'bronze' else ('2_silver' if highest_medallion == 'silver' else '3_gold') %}
                        {% set filename = item['Filename Base'] ~ (item['Bronze Filename Extension'] if highest_medallion == 'bronze' else '.txt') %}
                        <a href="{{ static_files_path }}/data/texts/{{ medallion_path }}/{{ filename }}" class="main-link" target="_blank">
                            <img src="{{ static_files_path }}/web/imgs/medallion_icons/{{ highest_medallion }}.png" alt="{{ highest_medallion }}" title="{{ highest_medallion }}" style="height: 20px; margin-right: 5px;">
                            {{ item['Title'] ~ (' - ' ~ item['Author'] if item['Author'] else '') }}
                        </a>
                        <details class="caret-details">
                            <summary class="toggle-caret"></summary>
                        </details>
                    </div>
                    <ul class="extra-links">
                        <li>
                            <a href="{{ static_files_path }}/data/metadata/transforms/{{ item['Filename Base'] }}.html" target="_blank">
                                <img src="{{ static_files_path }}/web/imgs/info.png" alt="metadata" style="height: 20px; margin-right: 2px;">
                                Metadata
                            </a>
                        </li>
                        {% if item['Other Versions'] %}
                        <li>
                            Other Versions:
                            {% for medallion in item['Other Versions'].split(',') %}
                                {% set medallion_lower = medallion.strip() | lower %}
                                {% set medallion_path = '1_bronze' if medallion_lower == 'bronze' else ('2_silver' if medallion_lower == 'silver' else '3_gold') %}
                                {% set filename = item['Filename Base'] ~ (item['Bronze Filename Extension'] if medallion_lower == 'bronze' else '.txt') %}
                                <a href="{{ static_files_path }}/data/texts/{{ medallion_path }}/{{ filename }}" title="{{ medallion.strip() }}">
                                    <img src="{{ static_files_path }}/web/imgs/medallion_icons/{{ medallion_lower }}.png" alt="{{ medallion.strip() }}" style="height: 20px; margin-right: 2px;">
                                </a>
                            {% endfor %}
                        </li>
                        {% endif %}
                    </ul>
                </li>
                {% endfor %}
            </ul>
        </div>

        {% include 'subtemplates/index_footer.html' %}

    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        document.querySelectorAll(".toggle-caret").forEach(caret => {
            caret.addEventListener("click", function(event) {
                event.preventDefault(); // Prevent default summary behavior
                let li = this.closest(".file-item"); // Find the parent <li>
                li.classList.toggle("open"); // Toggle the 'open' class
            });
        });
    });
</script>
</body>
</html>
